\chapter{Mobility Support}
\label{mobility support}

\section{Motivazioni per il supporto Mobile}

TCP / IP dispone di 3 livelli di protocollo superiori a quelli fisici:

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{tcp_ip_layers.png}
  \caption{TCP/IP layers}
  \label{fig:tcpiplayers}
\end{figure}

\textbf{Routing in Internet}

\begin{itemize}
  \item routing basato su prefissi: l'indirizzo IP di destinazione e il
prefisso di rete (es. 129.13.42) determinano la sottorete fisica
  \item un cambiamente della sottorete fisica implica un cambio
dell'indirizzo IP
  \item L'indirizzo IP è legato a una posizione (\textbf{point of attachment})
\end{itemize}

\textbf{Requisiti chiave per IP mobile}

\begin{itemize}
  \item \textbf{Raggiungibilità} - Un utente mobile deve rimanere
raggiungibile in qualsiasi momento attraverso un identificatore
permanente, indipendentemente dalla sua posizione attuale
(\textbf{subnet of attachment)}
  \item \textbf{Continuità} - Una comunicazione in corso non
dovrebbe interrompersi quando l'utente mobile si sposta (e va fuori dai
confini della sottorete)
\end{itemize}

\textbf{Requisiti desiderabili}

\begin{itemize}
  \item \textbf{Compatibilità} - Non dovrebbe esserci nessun cambiamento al
sistema corrente e ai routers
  \item \textbf{Trasparenza} - Continuità di comunicazione dopo l'interruzione
di un collegamento
  \item \textbf{Efficienza e scalabilità} - L'overhead dovrebbe essere
basso o nullo (in una tipica connessione a banda ridotta)
  \item \textbf{Sicurezza} - Autenticazione dei messaggi
\end{itemize}

\subsection{Problema e possibili soluzioni}

Nessuno degli strati TCP/IP è stato progettato per la mobilità.
I dispositivi mobili cambiano l'indirizzo IP mentre attraversano le
sottoreti e non sono più raggiungibili.

La modifica dell'indirizzo IP interrompe le connessioni del livello di
trasporto, quindi non c'è continuità. \\

\textbf{Tassonomia}

\begin{itemize}
  \item Scala: macro, micro
  \item Entità coinvolte nella gestione della mobilità: mobile-assistite,
network-only
  \item Mobilità di un nodo o di un gruppo
\end{itemize}

Come gestire la mobilità?\\

\textbf{Cambiare il livello IP / di rete} in modo tale che i livelli più alti
possano continuare a lavorare senza sapere nulla del cambiamento (soluzione
a livello di rete per la mobilità (es. MobileIP (v4, v6), GTP)

oppure...

\textbf{Cambiare il livello TCP / di trasporto} in modo tale che possa far
fronte ai cambiamenti degli identificatori degli end-point (soluzione a livello
di trasporto per la mobilità (es. Mobile TCP, SCTP)).

\textbf{Radice del problema}: l'indirizzo IP serve sia per la localizzazione,
sia come identificatore in connessioni TCP.

\subsection{Mobile IP}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{mobileip1.png}
  \caption{Mobile IP, entità coinvolte}
  \label{fig:mobileip1}
\end{figure}

MN (Mobile Node) può spostarsi ed è in grado di rilevare un cambio di rete
rimanendo periodicamente in ascolto di segnali trasmessi dal FA (Foreign
Agent).

HA (Home Agent) mantiene il binding (home address, care of address,
duration of validity).

Care of address: IP temporaneo per un dispositivo mobile.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{mobileip2.png}
  \caption{Esempio mobile IP, CN -> MN}
  \label{fig:mobileip2}
\end{figure}

Quando i pacchetti arrivano all'home address, l'Home Agent HA apre un tunnel
IP-in-IP (in rosso nell'immagine) verso il foreign agent FA e manda i 
pacchetti, che li manda a sua volta al nodo mobile, al suo nuovo indirizzo.

Il tunneling IP-in-IP significa che il pacchetto IP originale è incapsulato
in un altro pacchetto IP con il nuovo indirizzo di destinazione (nuovo care
of address).

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.2]{mobileip3.png}
  \caption{Esempio mobile IP, MN -> CN}
  \label{fig:mobileip3}
\end{figure}

Il nodo mobile può inviare una risposta direttamente o con un
reverse tunnel (es. firewall scenario) attraverso l'home agent HA
(l'home agent rigira la risposta al destinatario). \\

\textbf{Mobile IP - Aspetti negativi}

\begin{itemize}
  \item \textbf{Sicurezza} - Un codice malevolo può
dichiarare un nuovo care-of-address e rubare i pacchetti in arrivo
al nodo mobile.
Per evitare questo, l'home agent HA e il nodo mobile devono condividere
una chiave segreta e autenticare le loro comunicazioni
  \item \textbf{routes più lunghe} - I pacchetti devono percorrere una
distanza extra fino all'home agent HA e poi indietro (triangle routing).
MN potrebbe inviare direttamente il care-of-address al CN
che lo usa successivamente -> problemi di sicurezza / privacy!
  \item \textbf{Filtro dei pacchetti}
ISPs possono bloccare i pacchetti in arrivo da un nodo mobile se l'indirizzo
d'origine è il vecchio home address e non appartiene al blocco di IP della
rete corrente.
\end{itemize}

\textbf{Mobile IP - Aspetti positivi}

\begin{itemize}
  \item Risolve il problema della mobilità alla radice (IP è il livello più
basso di TCP/IP)
  \item Tracking-support integrato (con un indirizzo IP permanente e home agent
HA)
  \item Nessun cambiamento al core della rete (solo i routers di confine,
gli HA sono coinvolti) 
  \item Privacy della località
\end{itemize}

\textbf{Mobile IPv6}

\begin{itemize}
  \item In IPv6, la funzionalità del foreign agent FA è integrata nel nodo
mobile stesso
  \item L'ottimizzazione delle routes è una parte integrante del protocollo
  \item Sicurezza integrata
\end{itemize}

\section{Sistemi mobili cellulari}

\subsection{Disambiguazione}

\begin{enumerate}
  \item E-UTRA(N) - Evolved UMTS Terrestrial Radio Access (Network)
  \item Super 3G - Riferito a LTE
  \item 3.9G - Usato per indicare che LTE non è il 4G
\end{enumerate}

\textbf{Set di requisiti richiesti da ITU-R (Radiocommunication Sector)
dell'ITU (International Telecommunication Union) nel 2008 per il 4G:}

\begin{itemize}
  \item Basato su protocolo IP
  \item Interoperabilità con tutti gli standard wireless esistenti
  \item Un data rate nominale di 100 Mbit/s (su mobile) e 1 Gbit/s (quando
client e stazione sono in posizioni fisse (relative))
  \item Condivisione e utilizzo dinamico delle risorse della rete per
supportare più utenti per cella.
  \item Banda dei canali scalabile 5–20 MHz, fino a 40 MHz
  \item Efficienza massima di 15 bit/s/Hz in downlink, e 6.75
bit/s/Hz in uplink
  \item Connettività senza interruzioni e roaming globale attraverso reti
diverse, con handovers/handoff leggeri
  \item Efficienza per il sistema: 3 bit/s/Hz/cell in downlink
e 2.25 bit/s/Hz/cell per uso domestico
  \item Capacità di offrire un'alta qualità del servizio per il supporto
multimediale
\end{itemize}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.3]{mobtech.png}
  \caption{Previsione delle quote di mercato degli abbonamenti alle tecnologie
mobili in tutto il mondo dal 2016 al 2021}
  \label{fig:mobtech}
\end{figure}

\subsection{GSM}

GSM (Sistema globale per le comunicazioni mobili) è uno standard
sviluppato da ETSI (European Telecommunications Standards Institute) con lo
scopo di descrivere i \textbf{protocolli per la seconda generazione 2G} di reti
cellulari digitali per utenti mobili. \\

A partire dal 2014, è diventato lo standard mondiale de-facto per le
comunicazioni mobili con oltre 90 \% di mercato, operante in oltre 219 paesi
e territori.

Le reti 2G sono state sviluppate per sostituire le reti analogiche cellulari
di prima generazione (1G).

Lo standard GSM si è ampliato nel tempo fino a includere comunicazioni di
dati, dapprima grazie a un trasporto circuit-switched, poi tramite GPRS
(General Packet Radio Services) e EDGE (Enhanced Data rates for GSM
Evolution, or EGPRS)

Successivamente, il 3GPP ha sviluppato gli standard UMTS di terza generazione
(3G), seguiti da quelli di quarta generazione (4G) LTE standard avanzati,
che non fanno parte degli standard ETSI GSM.

\subsubsection{Storia...}

\textbf{1982 - nasce il gruppo speciale per la mobilità}

\textbf{1989} - European Telecommunications Standardization Institute
(ETSI) si assume la responsabilità di creare degli standard e cambia nome:
Global System for Mobile (GSM) communication

\textbf{1990} - Primo lancio ufficiale commerciale in Europa

GSM è la più popolare tecnologia 2G. La figura \ref{fig:gsm_table} mostra
alcune delle sue caratteristiche principali:

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{gsm_table.png}
  \caption{Tabella riassuntiva delle specifiche dello standard GSM Cellular
System}
  \label{fig:gsm_table}
\end{figure}

Una delle caratteristiche fondamentali di GSM è il \textbf{Subscriber Identity
Module}, comunemente conosciuto come una carta SIM.

La SIM è una smart card rimovibile contenente l'abbonamento dell'utente, le
sue informazioni e la sua rubrica telefonica.

Questo consente all'utente di mantenere i propri dati cambiando dispositivo.

In alternativa, l'utente può anche cambiare operatore mantenendo il
proprio dispositivo, semplicemente cambiando la SIM.

Alcuni operatori possono bloccare questa possibilità, permettendo a un
telefono di utilizzare una sola SIM, o solo una SIM emessa da quell'operatore;
questa pratica è conosciuta come blocco SIM.

\subsubsection{GSM – Architettura funzionale}

Una \textbf{rete GSM} comprende molte unità funzionali.
Può essere suddivisa in:

\begin{itemize}
  \item \textbf{Base station subsystem} (BSS) - stazione di base
  \item \textbf{Network and Switching Subsystem} (NSS) - la parte della
rete più simile a una rete fissa, a volte chiamata core network.
  \item \textbf{GPRS Core Network} (GPRS) - la parte \textbf{opzionale} che
permette connessioni Internet basate su pacchetti (vedi sezione \ref{sec:gprs})
  \item \textbf{Operations support system} (OSS) - manutenzione della rete
\end{itemize}

I componenti aggiuntivi dell'architettura GSM comprendono database e
\textbf{funzioni di messaggistica}:

\begin{itemize}
  \item VLR : Visitor Location Register
  \item HLR : Home Location Register
  \item AUC : Authentication Center
  \item BTS : Base Transceiver Station
  \item OMC : Operation Maintenance Center
  \item EIR : Equipment Identity Register
\end{itemize}

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.3]{archGSM.png}
  \caption{Struttura di una rete GSM}
  \label{fig:archGSM}
\end{figure}

Le stazioni di base (BTS) sono organizzate in piccoli gruppi, controllate da
una stazione di base di controllo (BSC) che è tipicamente co-localizzata in una
delle stazioni di base.

Tutto il sistema, composto dal BSC con i suoi BTS associati si chiama
\textbf{sottosistema di stazioni di base} (BSS). \\

Addentrandosi nella reta, c'è la zona principale di commutazione, nota come
\textbf{switching center mobile} (MSC).

Associati ad essa, ci sono i \textbf{registri di posizione}, cioè gli
home location registers (HLR) e i visitor location register (VLR) che tengono
traccia della località degli utenti mobili e consentono alle chiamate di
essere instradate a loro\\

Inoltre, ci sono il centro di autenticazione (AuC) e il equipment identify
register (EIR), utilizzati per l'autenticazione dei messaggi prima
che siano immessi sulla rete e per la fatturazione.

La MS e la BSS comunicano attraverso l'interfaccia Um (nota come
air-interface)

Il BSS comunica con il centro di Network Service Switching (NSS) attraverso
l'interfaccia A.

GSM è una rete cellulare, il che significa che i telefoni si
connettono ad essa tramite la ricerca di celle nelle immediate vicinanze.
Ci sono cinque tipi di celle, in base alle dimensioni, in una rete GSM:
celle \textit{macro, micro, pico, femto e umbrella}.

\section{General Packet Radio Service}
\label{sec:gprs}

General Packet Radio Service (\textbf{GPRS}) is a packet oriented mobile data
service on the 2G and 3G cellular communication system's GSM. It is now
maintained by the 3rd Generation Partnership Project (3GPP).

GPRS usage is typically charged (addebitato) based on volume of data
transferred.

GPRS is a best-effort service, implying variable throughput and latency that
depend on the number of other users sharing the service concurrently, as
opposed to circuit switching, where a certain quality of service (QoS) is
guaranteed during the connection.

In 2G systems, GPRS provides data rates of 56-114 kbit/second. \\

2G cellular technology combined with GPRS is sometimes described as 2.5G,
that is, a technology between the second (2G) and third (3G) generations of
mobile telephony. 2.5G is an attempt to improve data services from
2G.

It connects GSM networks to IP networks (it's basically an overlay network of
data service on 2G networks). Max data rate: 57 Kbps-171 kbit/second.

\subsubsection{GPRS - Quality of Service}
\begin{itemize}
  \item Service precedence (high, normal and low priority groups)
  \item Reliability
  \item Delay
  \item Throughput
\end{itemize}

\subsubsection{LTE – Definitions}

\begin{itemize}
  \item EPC (Evolved Packet Core): the new packet core architecture defined in
3GPP Rel-8
  \item SAE (System Architecture Evolution): the work item within 3GPP for
defining the EPC specifications
  \item LTE (Long Term Evolution): 3GPP work item that developed the radio
access technology and E-UTRAN
  \item EPS (Evolved Packet System): 3GPP term referring to a complete
end-to-end system, that is UE, E-UTRAN and Core Network (EPC)
  \item E-UTRAN - the RAN (radio access network) that implements LTE radio
interface technology
\end{itemize}

\subsection{UMTS - Universal Mobile Telecommunications System}

The Universal Mobile Telecommunications System (\textbf{UMTS}) is a third
generation mobile cellular system for networks based on the GSM standard.

Developed and maintained by the 3GPP, UMTS is a component of the International
Telecommunications Union IMT - 2000 standard set.

UMTS uses wideband code division multiple access (W-CDMA) radio access
technology to offer greater spectral efficiency and bandwidth to mobile network
operators.

UMTS specifies a complete network system, which includes the radio access
network (UMTS Terrestrial Radio Access Network, or UTRAN), the core network
(Mobile Application Part, or MAP) and the authentication of users via SIM
(subscriber identity module) cards.

The technology described in UMTS is sometimes also referred to as 3GSM.

\subsection{User equipment}

In the UMTS and 3GPP LTE, user equipment (UE) is any device used directly by an
end-user to communicate.

It can be a hand-held telephone, a laptop computer equipped with a mobile
broadband adapter, or any other device. \\

User Equipment (UE) comprised of:

\begin{itemize}
  \item Mobile Termination (MT) module (handles all the communication
functions)
  \item Terminal Equipment (TE) module (terminates the data streams)
  \item Universal Integrated Circuit Card (UICC) module (known as the SIM card
for LTE equipment's. It runs an application known as the Universal Subscriber
Identity Module (USIM))
\end{itemize}

\subsection{UTRAN - UMTS Terrestrial Radio Access Network}

Primarily a part of the 3G Mobile Communication Technology and defined as a
collective term for the BTS and Radio Network Controllers which make up the
UMTS radio access network.

Can carry many traffic types from real-time Circuit Switched to IP based Packet
Switched.

The UTRAN allows connectivity between the UE (user equipment) and the core
network.

The UTRAN contains the base stations, which are called Node Bs, and Radio
Network Controllers (RNC).
The RNC provides control functionalities for one or more Node Bs.
A Node B and an RNC can be the same device.

\subsection{E-UTRAN - Evolved Terrestrial Radio Access Network}

E-UTRAN is the network architechture defined for the E-UTRA radio interface as
a part of 3GPP LTE physical layer specification.

It handles radio communications between the mobile and the Evolved Packet Core.

Just one component: the evolved base stations, called \textbf{eNodeB} or eNB.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.6]{utran_net.jpg}
  \caption{E-UTRAN Architecture}
  \label{fig:utran_net}
\end{figure}

The eBN sends and receives radio transmissions to all the mobiles using the
analogue and digital signal processing functions of the LTE air interface.

The eNB controls the low-level operation of all its mobiles, by sending them
signaling messages such as handover commands.

\subsection{EPC - Evolved Packet Core}

The \textbf{EPC} is the latest evolution of the 3GPP core network architecture.
When designing the evolution of the 3G system, the 3GPP community decided to
use IP (Internet Protocol) as the key protocol to transport all services.
It was therefore agreed that the EPC would not have a circuit-switched domain
anymore and that the EPC should be an evolution of the packet-switched
architecture used in GPRS/UMTS.
This decision had consequences on the architecture itself but also on the way
that the services were provided.
Traditional use of circuits to carry voice and short messages needed to be
replaced by IP-based solutions in the long term.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{eps.jpg}
  \caption{circuit and packets domains}
  \label{fig:eps}
\end{figure}

\subsubsection{Architecture of the EPC}

L'idea dell'architettura EPC è quella di gestire il traffico dati in maniera
 efficiente dal punto di vista delle performance e dei costi

Pochi nodi della rete è coinvolta nella gestione del traffico e le conversioni
 di protocollo vengono evitate.

È stato inoltre deciso di separare i dati degli utenti (\textbf{user plan}) da quelli di segnalazione (noti come \textbf{control plane}) in modo tale rendere
 lo scaling indipendente.
Grazie a questa divisione funzionale, gli operatori possono essere
 dimensionati e adattati alla loro rete facilmente.

\begin{figure}[H]
  \centering
  \includegraphics[scale=0.7]{eps_arch.jpg}
  \caption{l'architettura di base degli EPC quando l'UE è connesso all'EPC tramite E-UTRAN(LTE)}
  \label{fig:eps_arch}
\end{figure}

L'Evolved NodeB (eNodeB) è una stazione base per le trasmissioni LTE. Nella
 figura \ref{fig:eps_arch}, l'EPC è composto da 4 elementi di rete:
\begin{itemize}
  \item gateway di servizio (Serving GW);
  \item PDN Gateway (PDN GW);
  \item MME;
  \item HSS.
\end{itemize}

L'EPC è connesso alle reti esterne che possono includere l'IP Multimedia Core 
Network Subsystem (IMS).
